# VSCode风格下拉工具栏实现说明

## 功能概述

将工具栏改为类似VSCode的下拉菜单风格，所有功能按分类组织在下拉菜单中，提供更专业和简洁的界面。

## 工具栏结构

### 下拉菜单分类

1. **导航** - 相机和UAV导航功能
2. **回放** - 轨迹回放控制
3. **视图** - 视图保存和恢复
4. **工具** - 辅助工具和帮助

### 菜单项详情

#### 导航菜单
- 🎯 聚焦选中的UAV (F)
- 📍 居中显示所有UAV (C)
- 🏠 重置相机到默认位置 (R)
- ──────────────
- ✕ 取消选择 (ESC)

#### 回放菜单
- ⏸/▶ 暂停/继续回放 (Space)
- ──────────────
- ⏩ 加快回放速度 (+)
- ⏪ 减慢回放速度 (-)
- ──────────────
- ▶ 开始回放
- ⏹ 停止回放

#### 视图菜单
- 💾 保存当前视图 (Ctrl+S)
- ↩ 恢复保存的视图 (Ctrl+R)

#### 工具菜单
- ❓ 显示快捷键帮助 (Shift+?)
- ──────────────
- 📊 显示性能监控 (Ctrl+Shift+P)
- 🗑 清除所有通知

## 实现细节

### 下拉菜单组件

**文件**: `components/dropdown-menu.js`

**功能**:
- 类似VSCode的下拉菜单样式
- 自动定位（避免超出屏幕）
- 点击外部自动关闭
- ESC键关闭
- 动画效果（滑入/滑出）
- 支持分隔线
- 支持禁用项
- 显示快捷键提示

**特点**:
- 深色主题，与整体UI一致
- 模糊背景效果
- 悬停高亮
- 快捷键显示在右侧

### 菜单项配置

菜单项通过数组配置，支持：
- `label`: 菜单项文本
- `icon`: 图标（emoji或字符）
- `shortcut`: 快捷键提示
- `action`: 点击执行的函数
- `disabled`: 是否禁用
- `'divider'`: 分隔线

### 动态更新

回放菜单会根据当前状态动态更新：
- 暂停/继续按钮文本和图标
- 开始/停止按钮的禁用状态

## 样式特点

### VSCode风格设计

- **工具栏**: 简洁的按钮，只显示分类名称和下拉箭头
- **下拉菜单**: 深色背景，清晰的层次结构
- **菜单项**: 图标+文字+快捷键，信息完整
- **交互**: 悬停高亮，点击执行，ESC关闭

### 响应式设计

- **桌面端**: 完整显示所有菜单
- **移动端**: 优化按钮大小，菜单自动适配屏幕

## 用户体验

### 优势

1. **专业外观**: 类似VSCode，用户熟悉
2. **功能分类**: 清晰的功能组织
3. **信息完整**: 每个菜单项显示图标、文字和快捷键
4. **空间节省**: 工具栏更简洁，节省空间
5. **易于扩展**: 添加新功能只需添加菜单项

### 快捷键仍然可用

- 所有快捷键功能保持不变
- 下拉菜单和快捷键调用相同的函数
- 用户可以选择使用菜单或快捷键

## 使用方法

### 打开菜单

点击工具栏上的分类按钮（导航、回放、视图、工具）即可打开对应的下拉菜单。

### 关闭菜单

- 点击菜单项执行操作后自动关闭
- 点击菜单外部关闭
- 按ESC键关闭

### 快捷键

所有快捷键仍然可用，与菜单项功能对应。

## 技术实现

### 组件架构

```
DropdownMenu (组件)
  ├── createMenu() - 创建菜单
  ├── createMenuItem() - 创建菜单项
  ├── positionMenu() - 定位菜单
  ├── bindEvents() - 绑定事件
  └── close() - 关闭菜单

DropdownManager (管理器)
  ├── getDropdown() - 获取/创建下拉菜单实例
  └── closeAll() - 关闭所有菜单
```

### 事件处理

- 点击按钮：打开/关闭菜单
- 点击菜单项：执行操作并关闭
- 点击外部：关闭菜单
- ESC键：关闭菜单

## 未来扩展

可以轻松添加新的菜单分类和菜单项：

1. 在 `initDropdownMenus()` 中添加菜单项配置
2. 创建对应的切换函数
3. 在模板中添加下拉按钮
4. 在return中导出函数

## 文件更新

- `components/dropdown-menu.js` - 下拉菜单组件（新建）
- `app.js` - 集成下拉菜单到工具栏
- `styles.css` - VSCode风格工具栏样式
- `index.html` - 加载下拉菜单组件
